<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ADM Panel Test</title>
  <link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.14.0.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="//code.jquery.com/qunit/qunit-1.14.0.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.11/require.js"></script>
  <script>
	require.config({
	    "paths": {
	      "jquery": "//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min"
	    }
	});
	require(['../js/adm', 'jquery'], function(adm, $) {
		QUnit.module('ResultTableController tests');
		QUnit.test("Test append headers", function(assert) {
			var ctrl = new adm.ResultTableController('.query-result');	
			var result1 = [{field : 'field1'}, {field : 'field2'}];
			ctrl.append(result1);
			assert.deepEqual(ctrl.headers, ['field1', 'field2']);
			var result2 = [{field : 'field1'}, {field : 'field3'}];
			ctrl.append(result2);
			assert.deepEqual(ctrl.headers, ['field1', 'field2', 'field3']);
			$('#qunit-fixture').html('<div class="query-result"><h1></h1><table><thead><tr></tr></thead><tbody></tbody></table></div>');
			console.info($('#qunit-fixture').html());
		});
		QUnit.test("Test append headers in table", function(assert) {
			var ctrl = new adm.ResultTableController('.query-result');	
			var result1 = [{field : 'field1'}, {field : 'field2'}];
			ctrl.append(result1);
			var theadRowEl = $(ctrl.view.el).find('table thead tr:eq(0)');
			assert.equal(theadRowEl.find('th:eq(0)').html(), 'field1');
			assert.equal(theadRowEl.find('th:eq(1)').html(), 'field2');
			$('#qunit-fixture').html('<div class="query-result"><h1></h1><table><thead><tr></tr></thead><tbody></tbody></table></div>');
			console.info($('#qunit-fixture').html());
		});
		QUnit.test("Test append values in table", function(assert) {
			var ctrl = new adm.ResultTableController('.query-result');	
			var result1 = [{field : 'field1', value : 'value1'}, {field : 'field2', value : 'value2'}];
			ctrl.append(result1);
			var firstRowEl = $(ctrl.view.el).find('table tbody tr:eq(0)');
			assert.equal(firstRowEl.find('td:eq(0)').html(), 'value1');
			assert.equal(firstRowEl.find('td:eq(1)').html(), 'value2');
			console.info($('#qunit-fixture').html());
		});
	});
  </script>
<div id="qunit"></div>
<div id="qunit-fixture">
	<div class="query-result">
		<h1></h1>
		<table>
			<thead>
				<tr></tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
</div>
</body>
</html>
